TODO
change all cast.lua funcs to take self (consistency)